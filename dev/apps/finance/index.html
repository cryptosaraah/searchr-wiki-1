<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Searchr">
        <link rel="canonical" href="https://squidfunk.github.io/mkdocs-material/dev/apps/finance/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Finance - Searchr</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../stylesheets/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-XXXXXXXX-X', 'auto');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../..">Searchr</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../documentation/whitepaper/">Whitepaper</a>
</li>
                            
<li >
    <a href="../../../documentation/aragonOS/">aragonOS</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Governance</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../documentation/Community_Governance_Model/">AGP2 - Community Governance Model</a>
</li>
            
<li >
    <a href="../../../documentation/Migration_to_Open_Source_Messaging_Platform/">AGP5 - Migration to Open Source Messaging Platform</a>
</li>
            
<li >
    <a href="../../../documentation/Merge_Aragon_HQ_and_Community_meetings/">AGP7 - Merge Aragon HQ and Community meetings</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Multisigs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../documentation/multisigs/overview/">Overview</a>
</li>
            
<li >
    <a href="../../../documentation/multisigs/foundation/">Foundation</a>
</li>
            
<li >
    <a href="../../../documentation/multisigs/community/">Community</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../../documentation/Development_Plan/">Development Plan</a>
</li>
                            
<li >
    <a href="../../../documentation/Code_of_Conduct/">Aragon Code of Conduct</a>
</li>
                            
<li >
    <a href="../../../documentation/presentations/">Presentations</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Audit reports</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../documentation/audits/audit01_report_dossa/">Audit 01 by Adam Dossa</a>
</li>
            
<li >
    <a href="../../../documentation/audits/audit_internal_sun/">Audit (Internal) by Brett Sun</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../../documentation/community_content/">Community Content</a>
</li>
                            
<li >
    <a href="../../../projects/">Third-party Projects</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">aragonOS</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../aragonOS_index/">Overview</a>
</li>
            
<li >
    <a href="../../aragonOS_how_to_contribute/">How to contribute</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Aragon Apps</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../">Overview</a>
</li>
            
<li >
    <a href="../voting/">Voting</a>
</li>
            
<li >
    <a href="../token-manager/">Token Manager</a>
</li>
            
<li >
    <a href="../group/">Group</a>
</li>
            
<li >
    <a href="../fundraising/">Fundraising</a>
</li>
            
<li >
    <a href="../vault/">Vault</a>
</li>
            
<li class="active">
    <a href="./">Finance</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Design <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../design/">Overview</a>
</li>
                            
<li >
    <a href="../../../design/logo/">Logo</a>
</li>
                            
<li >
    <a href="../../../design/artwork/">Artwork</a>
</li>
                            
<li >
    <a href="../../../design/identity_guidelines/">Identity Guidelines</a>
</li>
                            
<li >
    <a href="../../../design/branding_proposal/">Branding Proposal</a>
</li>
                            
<li >
    <a href="../../../design/merch/">Merchandise</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Meetings <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Community</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Community 08</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../meetings/community/08/">Agenda</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/alexa/">Write-Up - Alexa</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/brett/">Write-Up - Brett</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/john/">Write-Up - John</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/jorge/">Write-Up - Jorge</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/luis/">Write-Up - Luis</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/luke/">Write-Up - Luke</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/maria/">Write-Up - Maria</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/oliver/">Write-Up - Oliver</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/pierre/">Write-Up - Pierre</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm08/tatu/">Write-Up - Tatu</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Community 07</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../meetings/community/07/">Agenda</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/alexa/">Write-Up - Alexa</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/brett/">Write-Up - Brett</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/light-cm07/">Write-Up - John</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/jorge/">Write-Up - Jorge</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/luis/">Write-Up - Luis</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/luke/">Write-Up - Luke</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/maria/">Write-Up - Maria</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/oliver/">Write-Up - Oliver</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/pierre/">Write-Up - Pierre</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm07/tatu/">Write-Up - Tatu</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Community 06</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../meetings/community/06/">Agenda</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/brett/">Write-Up - Brett</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/john/">Write-Up - John</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/jorge/">Write-Up - Jorge</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/luis/">Write-Up - Luis</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/luke/">Write-Up - Luke</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/maria/">Write-Up - Maria</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/oliver/">Write-Up - Oliver</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/pierre/">Write-Up - Pierre</a>
</li>
            
<li >
    <a href="../../../meetings/community/write-ups/cm06/tatu/">Write-Up - Tatu</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../../meetings/community/05/">Community 05</a>
</li>
            
<li >
    <a href="../../../meetings/community/04/">Community 04</a>
</li>
            
<li >
    <a href="../../../meetings/community/03/">Community 03</a>
</li>
            
<li >
    <a href="../../../meetings/community/02/">Community 02</a>
</li>
            
<li >
    <a href="../../../meetings/community/01/">Community 01</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Jobs <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../jobs/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Openings</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../jobs/openings/solidity/">EVM/Solidity Engineer</a>
</li>
            
<li >
    <a href="../../../jobs/openings/frontend/">Frontend and web3 Developer</a>
</li>
            
<li >
    <a href="../../../jobs/openings/dev_rel/">Developer Relations</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Blog posts <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../blog/2018/">2018</a>
</li>
                            
<li >
    <a href="../../../blog/2017/">2017</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Videos <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../videos/tutorials/">Tutorials</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Meetings</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../videos/community/">Community</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../../videos/interviews/">Interviews</a>
</li>
                            
<li >
    <a href="../../../videos/presentations/">Presentations</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Press <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../press/press-kit/">Press Kit</a>
</li>
                            
<li >
    <a href="../../../press/media-mentions/">Media Mentions</a>
</li>
                            
<li >
    <a href="../../../press/contact/">Contact</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Aragon Nest <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../nest/">Overview</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Guides</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../nest/guides/guide_for_submitting_a_proposal_for_grants/">Guide for submitting a Proposal for a grant</a>
</li>
            
<li >
    <a href="../../../nest/guides/guide_for_submitting_a_request_for_funding/">Guide for submitting a new Request for funding</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Templates</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../nest/templates/ISSUE_TEMPLATE/">New Issue Template</a>
</li>
            
<li >
    <a href="../../../nest/templates/PULL_REQUEST_TEMPLATE/">New Pull Request Template</a>
</li>
            
<li >
    <a href="../../../nest/templates/team/">team.md Template</a>
</li>
            
<li >
    <a href="../../../nest/templates/roadmap/">roadmap.md Template</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../../../nest/faqs/">FAQ</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Archive <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Documentation</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../archive/documentation/agp5/RocketChat/">AGP5 - Rocket Chat comparison</a>
</li>
            
<li >
    <a href="../../../archive/documentation/agp5/Riot/">AGP5 - Riot comparison</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Meetings</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Aragon HQ</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../archive/meetings/hq/01/">HQ 01</a>
</li>
            
<li >
    <a href="../../../archive/meetings/hq/02/">HQ 02</a>
</li>
            
<li >
    <a href="../../../archive/meetings/hq/03/">HQ 03</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Dev</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../archive/meetings/dev/01/">Dev 01</a>
</li>
            
<li >
    <a href="../../../archive/meetings/dev/02/">Dev 02</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Videos</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Meetings</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../archive/videos/hq/">Aragon HQ</a>
</li>
            
<li >
    <a href="../../../archive/videos/dev/">Dev</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Translations <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Espa√±ol (Spanish)</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../translations/spanish/">Hola</a>
</li>
            
<li >
    <a href="../../../translations/spanish/aragonos/">aragonOS</a>
</li>
            
<li >
    <a href="../../../translations/spanish/devplan/">Development Plan</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../vault/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../../design/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/shaunnarayan/edit/master/docs/dev/apps/finance.md">Edit on shaunnarayan/searchr-wiki</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#finance">Finance</a></li>
            <li><a href="#definitions">Definitions</a></li>
            <li><a href="#initialization">Initialization</a></li>
            <li><a href="#lifecycle">Lifecycle</a></li>
            <li><a href="#payments_1">Payments</a></li>
            <li><a href="#periods">Periods</a></li>
            <li><a href="#limitations">Limitations</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="finance"><a href="https://github.com/aragon/aragon-apps/tree/master/apps/finance">Finance</a><a class="headerlink" href="#finance" title="Permanent link">&para;</a></h1>
<p><em><strong>Code in Github:</strong></em> <a href="https://github.com/aragon/aragon-apps/tree/master/apps/finance">aragon-apps/apps/finance</a></p>
<p>The purpose of the Finance app is to be the central point for keeping track of income and expenses in an organization, as well as performing payments.</p>
<p>The Finance app is multi-token (plus ether). In order to remove the need of a trusted prices feed (oracle) for token exchange rate, every token is accounted on its own for budgeting and period financial statements.</p>
<h3 id="definitions">Definitions<a class="headerlink" href="#definitions" title="Permanent link">&para;</a></h3>
<h4 id="accounting-period">Accounting period<a class="headerlink" href="#accounting-period" title="Permanent link">&para;</a></h4>
<p>Accounting periods are the equivalent of financial quarters in traditional organizations. Their length can be set depending on how the organization wants to use them.</p>
<p>For every accounting period, a balance (called token statement) for every transacted token is kept, this balance will be negative if more was spent than deposited and positive if otherwise.</p>
<h4 id="transactions">Transactions<a class="headerlink" href="#transactions" title="Permanent link">&para;</a></h4>
<p>A transaction records an event in which assets were deposited or spent through the Finance app. Spend transactions are called 'outgoing transactions' and deposits 'incoming transactions'. Every transaction occurs in an accounting period and counts towards its token statement.</p>
<p>Transactions cannot be created directly, they are recorded as the result of an operation (either a payment being executed or a deposit made).</p>
<h4 id="payments">Payments<a class="headerlink" href="#payments" title="Permanent link">&para;</a></h4>
<p>Payments are the construct used for spending using the Finance app. A payment can be created to happen only once or it can be a recurring payment that will be performed according to a certain time schedule.</p>
<p>If executing a payment succeeds, it creates an outgoing transaction with a reference to the payment.</p>
<h4 id="budgets">Budgets<a class="headerlink" href="#budgets" title="Permanent link">&para;</a></h4>
<p>Budgets give the ability to limit how much units of a token can be spent per Accounting period. Budgets are set in a token per token basis. By default no token has a budget, which means unlimited spending is allowed.</p>
<p>Once a budget has been set for a token, the Finance app will only allow the budgeted amount of tokens to be spent for that period.</p>
<h3 id="initialization">Initialization<a class="headerlink" href="#initialization" title="Permanent link">&para;</a></h3>
<p>Initializing a Finance app requires the following parameters:</p>
<ul>
<li><strong>Vault:</strong> a reference to a <a href="../vault/">Vault</a> instance that the Finance app will use for depositing and spending tokens. In order for it to work correctly, the Finance app <strong>must have permissions to transfer Vault's tokens</strong>.</li>
<li><strong>Ether token</strong>: address of the EtherToken instance used as ether.</li>
<li><strong>Accounting period duration</strong>: the initial duration for accounting periods. Can later be changed for future periods.</li>
</ul>
<h3 id="lifecycle">Lifecycle<a class="headerlink" href="#lifecycle" title="Permanent link">&para;</a></h3>
<h4 id="deposits">Deposits<a class="headerlink" href="#deposits" title="Permanent link">&para;</a></h4>
<p>Two deposit mechanisms are supported:</p>
<h5 id="erc20">ERC20<a class="headerlink" href="#erc20" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span>token.approve(finance, amount)
finance.deposit(token, amount, string reference)
</pre></div>


<p>After doing an ERC20 approval with the Finance app as spender, calling <code>deposit(...)</code> will create an incoming transaction saving the reference string.</p>
<h5 id="erc677">ERC677<a class="headerlink" href="#erc677" title="Permanent link">&para;</a></h5>
<div class="codehilite"><pre><span></span>token.transferAndCall(finance, amount, string reference)
</pre></div>


<p>Performing a ERC677 <code>transferAndCall(...)</code> to the Finance app will also trigger a deposit (intercepted with the <code>tokenFallback</code>). The data passed as payload to transferAndCall is used directly as the reference for the deposit.</p>
<p>Given that aragonOS' EtherToken implementation conforms to ERC677, depositing Ether to the Finance app can be done by wrapping the ether using <code>etherToken.wrap()</code> and then doing a <code>transferAndCall(...)</code> or using the shortcut <code>wrapAndCall(...)</code> which performs both actions.</p>
<p>Please note that this section is subject to change as the <a href="https://github.com/ethereum/EIPs/issues/677">ERC677 discussion</a> evolves.</p>
<h3 id="payments_1">Payments<a class="headerlink" href="#payments_1" title="Permanent link">&para;</a></h3>
<p>Depending on the parameters a payment is created with, it can be an instant one time payment, a recurrent payment for payroll or a scheduled payment.</p>
<h4 id="creating-payment">Creating payment<a class="headerlink" href="#creating-payment" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>finance.newPayment(...)
</pre></div>


<p>A payment is created with the following parameters:</p>
<ul>
<li><strong>Token</strong>: Address of token for payment.</li>
<li><strong>Receiver</strong>: Address that will receive payment.</li>
<li><strong>Amount</strong>: units of token that are payed every time the payment is due.</li>
<li><strong>Initial payment time</strong>: timestamp for when the first payment is done.</li>
<li><strong>Interval</strong>: number of seconds that need to pass between payment transactions.</li>
<li><strong>Maximum repeats</strong>: maximum instances a payment can be executed.</li>
</ul>
<p>In case a payment can already be executed on creation, it will be executed.</p>
<p>If a payment is created that won't be repeated ever again, and already was executed, only an outgoing transaction is recorded to save storage.</p>
<p>A payment can have a past <strong>initial payment time</strong>, which could cause many instances of the recurring payment to be executed at payment creation time.</p>
<h4 id="executing-payment">Executing payment<a class="headerlink" href="#executing-payment" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>finance.executePayment(uint256 _paymentId)
finance.receiverExecutePayment(uint256 _paymentId)
</pre></div>


<p>Payment execution will transfer the recipient of a payment the amount due depending on the current time. A single execution can result in multiple transactions if the payment hasn't been executed in time. To prevent it going out of gas when many transfers are due, a maximum amount of transfers are performed per execution (multiple executions could be needed in some instances).</p>
<p>Payments can always be executed by its recipient, but there is also an additional role to the Finance app that allows another entity to execute the payment (recipient gets the funds in both instances).</p>
<p>For payments whose token is the known EtherToken, instead of doing a token transfer, it will directly transfer ether to the recipient.</p>
<p>A payment execution can fail in case the organization is out of budget for the payment token for that particular accounting period, or the organization doesn't have enough token balance.</p>
<h4 id="disabling-payments">Disabling payments<a class="headerlink" href="#disabling-payments" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>finance.setPaymentDisabled(uint256 _paymentId, bool _disabled)
</pre></div>


<p>At any time, a payment can be disabled by an authorized entity. If a payment hasn't been fully executed until that time and it is disabled, the recipient won't be able to execute it until it is enabled again.</p>
<h3 id="periods">Periods<a class="headerlink" href="#periods" title="Permanent link">&para;</a></h3>
<h4 id="setting-duration">Setting duration<a class="headerlink" href="#setting-duration" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>finance.setPeriodDuration(uint64 _periodDuration)
</pre></div>


<p>Sets the period duration for next periods. The current period duration cannot be modified.</p>
<h4 id="setting-budget">Setting budget<a class="headerlink" href="#setting-budget" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>finance.setBudget(ERC20 _token, uint256 _amount)
</pre></div>


<p>Updates the budget of a token for accounting periods. Newly set budget is automatically enforced for the current period.</p>
<h4 id="removing-budget">Removing budget<a class="headerlink" href="#removing-budget" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>finance.removeBudget(ERC20 _token)
</pre></div>


<p>Removes budget for a token, allowing unlimited spending of that token in any period. Removing budget affects the current period.</p>
<h4 id="transitioning-periods">Transitioning periods<a class="headerlink" href="#transitioning-periods" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>finance.tryTransitionAccountingPeriod(uint ttl)
</pre></div>


<p>All operations that can result in the creation of a transaction (creating a payment, executing a payment, performing a deposit) first check whether the accounting period needs to be transitioned (previous period has end time has passed) or it can be triggered manually by calling <code>tryTransitionAccountingPeriod(...)</code>.</p>
<p>If many periods passed (last operation occurred two periods ago, but never transitioned), an empty period is created for every one of them.</p>
<p>To prevent the case in which the Finance app cannot perform any operation because it needs to transition too many accounting periods, causing any operation to go out of gas, transitioning periods has a parameter for how many periods it will transition. Automatic transitions will only perform 10 transitions maximum, and if more were needed the operation will fail. In case this lock occurs and periods cannot be automatically transitioned, multiple period transitions operations can be triggered manually to remove the lockup.</p>
<h3 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h3>
<ul>
<li>Payments are allowed to be created but can make it go out of budget. It can cause a race to execute payments right at the beginning of an Accounting period.</li>
<li>Payment executions do not expire. There is an attack vector in which by not executing a payment in some time, a budget can be impacted when executed. In case this is happening, payment can be executed by another allowed entity or it could be disabled.</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2016 - 2018 Searchr</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../../..';</script>
        <script src="../../../js/base.js"></script>
        <script src="../../../javascript/extra_js.js"></script>
        <script src="../../../search/require.js"></script>
        <script src="../../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
